<template>
  <div class="remove">
      <div class="table">
        <el-table
          :data="stuList"
          stripe
          style="width: 100%">
          <el-table-column type="expand">
            <template slot-scope="props">
              <el-form label-position="left" inline class="demo-table-expand">
                <el-form-item label="身份证号">
                  <span>{{ props.row.idcard }}</span>
                </el-form-item>
                <el-form-item label="家长姓名">
                  <span>{{ props.row.father }}</span>
                </el-form-item>
                <el-form-item label="家长电话">
                  <span>{{ props.row.fatherPhone }}</span>
                </el-form-item>
                <el-form-item label="入学学期">
                  <span>{{ props.row.xq }}</span>
                </el-form-item>
                <el-form-item label="出生年月">
                  <span>{{ props.row.birthday }}</span>
                </el-form-item>
                <el-form-item label="生源地">
                  <span>{{ props.row.category }}</span>
                </el-form-item>
                <el-form-item label="民族">
                  <span>{{ props.row.nationname }}</span>
                </el-form-item>
                <el-form-item label="政治面貌">
                  <span>{{ props.row.politicalStatusname }}</span>
                </el-form-item>
                <el-form-item label="家庭住址">
                  <span>{{ props.row.address }}</span>
                </el-form-item>
              </el-form>
            </template>
          </el-table-column>
          <el-table-column
            type="index"
            label="序号"
            width="50">
          </el-table-column>
          <el-table-column
            prop="name"
            label="学生姓名"
            width="80">
          </el-table-column>
          <el-table-column
            prop="no"
            label="学生姓名"
            width="120">
          </el-table-column>
          <el-table-column
            prop="assetsType"
            label="照片"
            width="80"
            >
            <template slot-scope="scope">
              <span>
              <img style="width: 35px;height:25px;" v-if="scope.row.photo !== '' && scope.row.photo !== null" :src="scope.row.photo | getsrc"/>
              <svg t="1518072932083" class="icon" v-if="scope.row.photo == '' || scope.row.photo == null"  viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3846" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="25"><defs></defs><path d="M921.273361 284.410562c1.732457-67.196425-43.048445-121.972982-121.114428-120.641661-191.071733 3.260254-382.278543 3.326768-573.346183-0.079818-74.853825-1.334391-126.530788 43.895743-124.050294 122.177644 3.672646 115.866914 0.904603 231.937466 0.953721 347.922061 0.01842 42.470277-0.500397 84.96102 0.602727 127.407762 1.13587 43.776016 23.833825 74.739215 63.998593 89.757257 19.272949 7.206122 41.523719 8.79941 62.443168 8.885368 164.988682 0.687662 329.980433 0.406253 494.972185 0.372483 9.794064-0.002047 19.751856 0.621147 29.353538-0.860601 40.656979-6.274914 54.06536-39.078017 29.011754-71.109548-6.999414-8.947789-15.836687-16.46909-23.924899-24.550139-53.108568-53.05638-106.242719-106.08513-161.28943-161.040766 41.047882-50.519604 56.205093-52.086285 96.514147-12.325723 45.354977 44.738947 90.105181 90.090854 135.24117 135.052882 8.084119 8.05342 15.827477 17.002232 25.342178 22.959921 27.457352 17.190521 56.961316 4.000104 63.09399-27.871791 1.827625-9.497305 1.12973-19.533892 1.133823-29.321816C920.261311 555.556005 917.77877 419.905512 921.273361 284.410562zM623.580285 743.239572c7.504928 7.525394 13.901615 16.154935 25.768897 30.092365-17.9887 1.465374-28.578896 3.062755-39.170115 3.078105-120.583333 0.174985-241.166665 0.414439-361.748974-0.034792-53.900607-0.200568-63.378469-9.556657-63.605643-62.427818-0.188288-43.908022-10.276041-92.654236 5.395894-130.377396 15.685237-37.752836 57.394175-64.97892 88.574315-95.933933 37.821397-37.551244 51.237965-37.648458 88.976474-0.178055C453.339995 572.417021 538.441209 657.847739 623.580285 743.239572zM837.183174 615.135962c-28.420283-28.105105-48.690956-48.114834-68.920696-68.167542-15.06716-14.935154-29.474288-30.598902-45.232181-44.76146-46.198182-41.520649-98.868775-41.834804-144.913461-0.369414-12.021801 10.825556-21.283746 24.715915-33.897018 39.667441-14.228049-11.58178-24.477484-18.659989-33.224706-27.26497-37.222763-36.624129-73.323982-74.41278-111.110587-110.435205-48.516993-46.25037-104.008842-46.752814-152.029532-0.718361-17.48421 16.761756-30.779004 37.894052-45.984311 57.032948-5.625114-3.344165-11.251252-6.687306-16.876366-10.030447 0-53.318346-1.178849-106.673531 0.478907-159.940712 0.87595-28.131711 15.031345-40.506553 42.894949-43.862997 9.665127-1.162476 19.558451-0.51984 29.348422-0.520863 169.72045-0.022513 339.440899-0.11768 509.161349 0.035816 61.667501 0.057305 72.113411 10.076496 72.356958 69.957305 0.343831 84.857667 0.14224 169.72045 0.017396 254.581186C839.235926 581.170382 838.287321 592.004125 837.183174 615.135962z" p-id="3847"></path></svg>
              </span>
            </template>
          </el-table-column>
          <el-table-column
            prop="sexname"
            label="性别"
            width="50">
          </el-table-column>
          <el-table-column
            prop="proname"
            label="专业">
          </el-table-column>
          <el-table-column
            prop="gradename"
            label="年级">
          </el-table-column>
          <el-table-column
            prop="xzbname"
            label="行政班">
          </el-table-column>
          <el-table-column
            prop="clazzname"
            label="教学班">
          </el-table-column>
          <el-table-column
            label="操作"
            width="180"
            >
            <template slot-scope="scope">
              <el-button
                size="mini"
                plain
                type="success"
                @click="deleteOption(scope.row.id, '0')">还原</el-button>
              <el-button
                size="mini"
                type="danger"
                @click="delSure(scope.row.id, '2')">删除</el-button>
            </template>
          </el-table-column>
        </el-table>
        <div class="Pagination">
          <el-pagination
            @size-change="handleSizeChange"
            @current-change="handleCurrentChange"
            :current-page.sync="page.pageNo"
            :page-sizes="[10, 20, 30, 40]"
            :page-size="page.pageSize"
            layout="total, sizes, prev, pager, next, jumper"
            :total="page.count">
          </el-pagination>
        </div>
      </div>
    </div>
</template>

<script>
import userApi from '../../apis/userCenter.js'
import api from '../../apis/login.js'
export default {
  name: 'remove',
  data () {
    return {
     currentPage3: 5,
      stuList: [],
      page: {
        pageSize:10,
        pageNo:1,
        count:0
      }
    }
  },
  props: {
    remove: null,
  },
  components: {
  },
  filters: {
    getsrc: function (value) {
      if(value){
        return  userApi.getCommonShowUrl(value);
      }
    }
  },
  mounted() {
    this.getlist();
  },
  methods: {
    delSure(id, type) {
      this.$confirm('此操作将永久删除, 是否继续?', '提示', {
        confirmButtonText: '确定',
        cancelButtonText: '取消',
        type: 'warning'
      }).then(() => {
        this.deleteOption(id, type);
      }).catch(() => {
        this.$message({
          type: 'info',
          message: '已取消删除'
        });          
      });
    },
    deleteOption(id, type){ 
      let params = {ids:id, type:type, userType:3};
      var qs = require('querystring');
      userApi.deleteOption(qs.stringify(params)).then(data=>{
        userApi.showMsg(data.data.meta);
        this.getlist();
      });
    },
    getlist() {
      let params = {
        tabType: "3",
        pageNo: this.page.pageNo,
        pageSize: this.page.pageSize
      };
      api.get_stulist(params).then(data=>{
        let page = data.data.data;
        this.page.pageNo = page.pageNo;
        this.page.pageSize = page.pageSize;
        this.page.count = page.count;
        this.stuList = page.list;
      });
    },
    handleSizeChange(val) {
      this.page.pageSize = val;
      this.getlist();
    },
    handleCurrentChange(val) {
      this.page.pageNo = val;
      this.getlist();
    },
  },
  watch:{
    remove: function () {
      if (this.remove !== null) {
        this.page.pageNo = this.remove.pageNo;
        this.page.pageSize = this.remove.pageSize;
        this.page.count = this.remove.count;
        this.stuList = this.remove.list;
      }
    }
  }

}
</script>
<style scoped>
.table{
  padding-left:16px;
  padding-right:16px;
  text-align:left;
}
.table-end-caozuo{
  height:24px;
  line-height:24px;
  display:inline-block;
  cursor:pointer;
  margin-right: 5px;
}
.table-end-caozuo img{
  vertical-align: middle;
}
.Pagination{
  margin-top:32px;
  margin-bottom:60px;
  text-align:center;
}
.remove .demo-table-expand .el-form-item {
  margin-right: 0;
  margin-bottom: 0;
  width:33.3%;
}
</style>
